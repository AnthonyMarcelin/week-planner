import{r as m,u as W,j as e,H as G}from"./app-C2V9p_DR.js";import{A as Q}from"./AuthenticatedLayout-D3RACkF4.js";import{M as K,S as H}from"./SecondaryButton-DQsFervw.js";import{P as F}from"./PrimaryButton-B4_6eGe-.js";import{T as _,I as N}from"./TextInput-HKVJco_C.js";import{I as u}from"./InputLabel-BicsjZ6d.js";import{C as X}from"./Checkbox-CGe4Zj-K.js";import"./ApplicationLogo-D06v9PWx.js";import"./transition-Gwxb2Fdn.js";const k=h=>{if(!h)return 0;const[g,w]=h.split(":").map(Number);return g+w/60},O=40;function oe({auth:h,activities:g}){const[w,n]=m.useState(!1),[v,R]=m.useState(!0),[d,C]=m.useState(!1),[S,A]=m.useState(0),[x,M]=m.useState(0),b=v?4:0,$=Array.from({length:24-b},(t,s)=>s+b),{data:r,setData:i,post:L,put:P,delete:I,processing:U,errors:f,reset:E,clearErrors:T}=W({id:null,label:"",start_time:"",end_time:"",type:"pro",days:[],day_of_week:null,group_id:null,scope:"single"}),y=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],c=m.useMemo(()=>{const t=new Date,s=t.getDay(),l=s===0?-6:1-s,o=new Date(t);o.setDate(t.getDate()+l);const a=new Date(o);a.setDate(o.getDate()+x*7);const p=new Date(a);p.setDate(a.getDate()+6);const D=j=>j.toLocaleDateString("fr-FR",{day:"numeric",month:"long"});return{start:D(a),end:D(p),mondayObject:a,todayString:new Date().toLocaleDateString("fr-FR")}},[x]),q=()=>{C(!1),i({id:null,label:"",start_time:"",end_time:"",type:"pro",days:[],day_of_week:null,group_id:null,scope:"series"}),T(),n(!0)},z=t=>{C(!0),i({id:t.id,label:t.label,start_time:t.start_time.slice(0,5),end_time:t.end_time.slice(0,5),type:t.type,days:[],day_of_week:t.day_of_week,group_id:t.group_id,scope:"single"}),T(),n(!0)},V=t=>{t.preventDefault();const s={onSuccess:()=>{n(!1),E()}};d?P(`/activities/${r.id}`,s):L("/activities",s)},B=()=>{const t=r.scope==="series"?"Voulez-vous vraiment supprimer TOUTE la sÃ©rie (4 semaines) ?":"Voulez-vous vraiment supprimer UNIQUEMENT cette activitÃ© ?";confirm(t)&&I(`/activities/${r.id}`,{data:{scope:r.scope},onSuccess:()=>{n(!1),E()}})},J=t=>{const s=r.days;i("days",s.includes(t)?s.filter(l=>l!==t):[...s,t])};return e.jsxs(Q,{user:h.user,header:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 tracking-tight",children:"Mon Planning"}),e.jsxs("div",{className:"flex items-center bg-white rounded-xl shadow-sm border border-slate-200 p-1",children:[e.jsx("button",{onClick:()=>M(t=>Math.max(0,t-1)),disabled:x===0,className:"p-2 hover:bg-slate-50 disabled:opacity-30 rounded-lg transition text-slate-600",children:"â¬…ï¸"}),e.jsxs("span",{className:"px-2 sm:px-4 text-xs sm:text-sm font-bold text-slate-700 w-[180px] sm:w-[220px] text-center truncate",children:[c.start," - ",c.end]}),e.jsx("button",{onClick:()=>M(t=>Math.min(3,t+1)),disabled:x===3,className:"p-2 hover:bg-slate-50 disabled:opacity-30 rounded-lg transition text-slate-600",children:"âž¡ï¸"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-end",children:[e.jsx(H,{onClick:()=>R(!v),className:"text-xs",children:v?"ðŸ‘ï¸ 00h+":"ðŸŒ™ Cacher"}),e.jsx(F,{onClick:q,className:"text-xs whitespace-nowrap",children:"+ ActivitÃ©"})]})]})}),children:[e.jsx(G,{title:"Planning"}),e.jsx("div",{className:"py-6 sm:py-12 bg-slate-50/50 min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsx("div",{className:"md:hidden flex overflow-x-auto pb-4 gap-2 px-4 scrollbar-hide",children:y.map((t,s)=>{const l=new Date(c.mondayObject);l.setDate(l.getDate()+s);const o=l.toLocaleDateString("fr-FR")===c.todayString;return e.jsxs("button",{onClick:()=>A(s),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-all shadow-sm border flex flex-col items-center
                                        ${S===s?"bg-indigo-600 text-white border-indigo-600":o?"bg-white text-indigo-600 border-indigo-200 ring-2 ring-indigo-100":"bg-white text-slate-500 border-slate-200"}`,children:[e.jsx("span",{children:t.slice(0,3)}),e.jsx("span",{className:"text-[10px] font-normal",children:l.getDate()})]},t)})}),e.jsxs("div",{className:"flex bg-white shadow-xl shadow-slate-200/60 sm:rounded-2xl overflow-hidden border border-slate-200",children:[e.jsx("div",{className:"w-14 sm:w-20 bg-slate-50/50 border-r border-slate-200 pt-[48px] flex-shrink-0",children:$.map(t=>e.jsxs("div",{className:"h-[40px] text-[10px] sm:text-xs text-slate-400 text-center border-b border-slate-100 font-medium flex items-center justify-center",children:[t.toString().padStart(2,"0"),":00"]},t))}),e.jsx("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-7 overflow-hidden md:min-w-[840px] md:overflow-x-auto",children:y.map((t,s)=>{const l=new Date(c.mondayObject);l.setDate(l.getDate()+s);const o=l.toLocaleDateString("fr-FR")===c.todayString;return e.jsxs("div",{className:`relative border-r border-slate-100 last:border-r-0 ${S===s?"block":"hidden md:block"}`,children:[e.jsxs("div",{className:`h-[48px] border-b border-slate-200 flex flex-col items-center justify-center font-bold text-[10px] uppercase tracking-widest transition-colors
                                            ${o?"bg-indigo-600 text-white shadow-inner":"bg-slate-50/30 text-slate-600"}`,children:[e.jsx("span",{children:t}),e.jsxs("span",{className:`text-[9px] ${o?"text-indigo-100":"text-slate-400"}`,children:[l.getDate()," ",l.toLocaleDateString("fr-FR",{month:"short"}).toUpperCase()]})]}),e.jsxs("div",{className:"relative",children:[$.map(a=>e.jsx("div",{className:"h-[40px] border-b border-slate-50"},a)),g&&g.filter(a=>Number(a.day_of_week)===s&&k(a.start_time)>=b&&Number(a.week_index)===x).map(a=>{const p=k(a.start_time),j=k(a.end_time)-p;return e.jsxs("div",{onClick:()=>z(a),className:`absolute left-1 right-1 rounded-md p-2 text-[10px] leading-tight overflow-hidden shadow-sm border-l-4 z-10 cursor-pointer transition-all hover:brightness-95 hover:scale-[1.01]
                                                                ${a.type==="pro"?"bg-indigo-50 text-indigo-700 border-indigo-500":"bg-emerald-50 text-emerald-700 border-emerald-500"}`,style:{top:`${(p-b)*O}px`,height:`${j*O}px`},children:[e.jsx("div",{className:"font-bold truncate",children:a.label}),e.jsxs("div",{className:"opacity-80 font-medium",children:[a.start_time.slice(0,5)," ",j>=1&&`- ${a.end_time.slice(0,5)}`]})]},a.id)})]})]},t)})})]})]})}),e.jsx(K,{show:w,onClose:()=>n(!1),children:e.jsxs("form",{onSubmit:V,className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 tracking-tight",children:d?"Modifier l'activitÃ©":"Nouvelle ActivitÃ©"}),d&&e.jsx("button",{type:"button",onClick:B,className:"text-red-500 hover:text-red-700 text-xs font-bold uppercase tracking-tighter transition",children:"Supprimer"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"label",value:"Nom de l'activitÃ©"}),e.jsx(_,{id:"label",value:r.label,onChange:t=>i("label",t.target.value),className:"mt-1 block w-full",placeholder:"ex: RÃ©union Client, Sport..."}),e.jsx(N,{message:f.label,className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{value:"â° DÃ©but"}),e.jsx(_,{type:"time",value:r.start_time,onChange:t=>i("start_time",t.target.value),className:"mt-1 block w-full"}),e.jsx(N,{message:f.start_time,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{value:"ðŸ Fin"}),e.jsx(_,{type:"time",value:r.end_time,onChange:t=>i("end_time",t.target.value),className:"mt-1 block w-full"}),e.jsx(N,{message:f.end_time,className:"mt-1"})]})]}),d&&r.group_id&&e.jsxs("div",{className:"p-3 bg-indigo-50 rounded-lg border border-indigo-100",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx(X,{name:"scope",checked:r.scope==="series",onChange:t=>i("scope",t.target.checked?"series":"single")}),e.jsx("span",{className:"ms-2 text-sm text-indigo-900 font-medium",children:"Appliquer aux 4 semaines"})]}),e.jsx("p",{className:"text-[10px] text-indigo-600 mt-1 ml-6",children:"Si cochÃ©, la modification ou la suppression s'appliquera Ã  toute la sÃ©rie."})]}),!d&&e.jsxs("div",{children:[e.jsx(u,{value:"Jours de la semaine",className:"mb-2"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>J(s),className:`px-3 py-1.5 rounded-lg border text-xs font-bold transition-all ${r.days.includes(s)?"bg-indigo-600 text-white border-indigo-600 shadow-md":"bg-slate-50 text-slate-500 border-slate-200 hover:border-slate-300"}`,children:t.slice(0,3)},t))}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 italic",children:"CrÃ©era automatiquement l'activitÃ© pour les 4 semaines Ã  venir."}),e.jsx(N,{message:f.days,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{value:"CatÃ©gorie",className:"mb-2"}),e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{type:"button",onClick:()=>i("type","pro"),className:`flex-1 py-2 text-xs rounded-lg transition-all ${r.type==="pro"?"bg-white shadow-sm font-bold text-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ’¼ Professionnel"}),e.jsx("button",{type:"button",onClick:()=>i("type","perso"),className:`flex-1 py-2 text-xs rounded-lg transition-all ${r.type==="perso"?"bg-white shadow-sm font-bold text-emerald-600":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Personnel"})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx(H,{onClick:()=>n(!1),children:"Annuler"}),e.jsx(F,{disabled:U,children:d?"Mettre Ã  jour":"Planifier"})]})]})})]})}export{oe as default};
